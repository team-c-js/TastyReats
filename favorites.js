import"./assets/popus-DgXYRxX_.js";import{a as u,i as h}from"./assets/vendor-Dj3mOgk7.js";const y={BASE_URL:"https://tasty-treats-backend.p.goit.global/api",ENDPOINTS:{RECIPES:"/recipes"}};u.defaults.baseURL=y.BASE_URL;const m=(e,t="")=>(h.error({title:"Hata",message:`Bir sorun oluştu (${t}): ${e.message}`,position:"topRight",timeout:4e3}),null),S={async getAllFavoriteRecipes(e=[]){try{const t=e.map(o=>u.get(`${y.ENDPOINTS.RECIPES}/${o}`));return(await Promise.all(t)).map(o=>o.data)}catch(t){return m(t,"getAllFavoriteRecipes")}}},r={currentState:{page:1,category:null},allCategories:[],categoriesLoaded:!1,loader:document.getElementById("loader"),showLoader(){this.loader&&(this.loader.style.display="block")},hideLoader(){this.loader&&(this.loader.style.display="none")},createFoodsCard(e){var a;const t=document.querySelector(".favorites-food");if(!t)return;t.innerHTML="";const i=document.querySelector(".pagination");if(i&&(i.style.display="block"),!e.results||e.results.length===0){this.currentState.category?t.innerHTML=`<p class="favorites-category-empty">No recipes found in the '${this.currentState.category}' category.</p>`:this.showFavoritesError(),i&&(i.style.display="none");return}for(const o of e.results){const c=document.createElement("li");c.className="foodsList-item",c.dataset.id=o._id;const n=this.Getstars(o.rating),p="fa-heart";c.innerHTML=`
        <img src="${o.thumb}" alt="${o.preview}" class="foodsList-itemImg">
        <div class="food-content">
          <div class="heartDiv">
            <i class="fa ${p} fa-2x foodsHeart" aria-hidden="true" data-id="${o._id}"></i>
          </div>
          <div class="food-box-content">
            <h3 class="foodContent-title">${o.title}</h3>
            <p class="foodContent-text">${(a=o.description)==null?void 0:a.slice(0,60)}...</p>
            <div class="raiting-foodContainer">
              <div class="raiting-food">
                <span class="raiting-foodPoint">${o.rating}
                  <span class="raiting-foodStars">${n}</span>
                </span>
                <button class="raiting-foodButton" data-id="${o._id}" data-popup="popup-food">See recipe</button>
              </div>
            </div>
          </div>
        </div>
      `,t.appendChild(c)}this.renderPagination(e.totalPages,e.page)},Getstars(e){let t="";const i=Math.floor(e);for(let a=0;a<5;a++)t+=a<i?'<i class="fa fa-star popup-star active" aria-hidden="true"></i>':'<i class="fa fa-star popup-star" aria-hidden="true"></i>';return t},renderPagination(e,t){t=Number(t);const i=document.getElementById("paginationContainer"),a=document.querySelector(".pagination");if(!i||!a)return;if(e<=1){a.style.display="none";return}a.style.display="flex",i.innerHTML="";const o=document.getElementById("firstPage"),c=document.getElementById("prevPage"),n=document.getElementById("nextPage"),p=document.getElementById("lastPage");o.classList.toggle("disabled",t===1),c.classList.toggle("disabled",t===1),n.classList.toggle("disabled",t===e),p.classList.toggle("disabled",t===e),o.onclick=s=>{s.preventDefault(),t!==1&&l.init(1)},c.onclick=s=>{s.preventDefault(),t>1&&l.init(t-1)},n.onclick=s=>{s.preventDefault(),t<e&&l.init(t+1)},p.onclick=s=>{s.preventDefault(),t!==e&&l.init(e)};const f=s=>{const d=document.createElement("a");return d.href="#",d.textContent=s,d.className="pagination-btn",s===t&&d.classList.add("active"),d.addEventListener("click",g=>{g.preventDefault(),l.init(s)}),d};e>1&&i.appendChild(f(1)),t>3&&i.appendChild(document.createTextNode("..."));for(let s=t-1;s<=t+1;s++)s>1&&s<e&&i.appendChild(f(s));t<e-2&&i.appendChild(document.createTextNode("...")),e>1&&i.appendChild(f(e))},showFavoritesError(){const e=document.querySelector(".favorites-errors"),t=document.querySelector(".favorites-food");e&&(e.style.display="flex");const i=document.querySelector(".favorites-list");i&&(i.innerHTML=""),t&&(t.innerHTML="")},hideFavoritesError(){const e=document.querySelector(".favorites-errors");e&&(e.style.display="none")},handleEmptyFavorites(){const e=document.querySelector(".pagination");this.showFavoritesError(),e&&(e.style.display="none"),this.categoriesLoaded=!1,this.allCategories=[],l.allFavoriteRecipeObjects=[],this.currentState.category=null,this.currentState.page=1},renderCategoryButtons(){const e=document.querySelector(".favorites-list");e&&(e.innerHTML=`<button class="favorites-btn ${this.currentState.category===null?"active":""}" data-category="all">All Categories</button>`,this.allCategories.forEach(t=>{const i=this.currentState.category===t,a=document.createElement("button");a.className=`favorites-btn ${i?"active":""}`,a.textContent=t,a.dataset.category=t,e.appendChild(a)}),this.setupCategoryButtons())},setupCategoryButtons(){const e=document.querySelectorAll(".favorites-btn");e.forEach(t=>{t.addEventListener("click",i=>{e.forEach(a=>a.classList.remove("active")),i.target.classList.add("active"),r.currentState.category=i.target.dataset.category==="all"?null:i.target.dataset.category,l.init(1)})})},setupEventDelegation(){document.addEventListener("click",e=>{const t=e.target;if(t.classList.contains("foodsHeart")){const i=t.dataset.id;let a=JSON.parse(localStorage.getItem("favoriteFoods"))||[];if(a.includes(i)){const o=l.allFavoriteRecipeObjects.find(n=>n._id===i),c=o?o.category:null;if(a=a.filter(n=>n!==i),localStorage.setItem("favoriteFoods",JSON.stringify(a)),l.allFavoriteRecipeObjects=l.allFavoriteRecipeObjects.filter(n=>n._id!==i),a.length===0){this.handleEmptyFavorites();return}if(c&&!l.allFavoriteRecipeObjects.some(p=>p.category===c)){this.allCategories=this.allCategories.filter(p=>p!==c),this.currentState.category=null,this.renderCategoryButtons(),l.init(1);return}l.init(this.currentState.page)}}})}},l={allFavoriteRecipeObjects:[],async init(e=1){try{r.showLoader(),r.currentState.page=e;const t=JSON.parse(localStorage.getItem("favoriteFoods"))||[];if(t.length===0){r.handleEmptyFavorites(),r.hideLoader();return}if(r.hideFavoritesError(),!r.categoriesLoaded||l.allFavoriteRecipeObjects.length!==t.length){const d=await S.getAllFavoriteRecipes(t);if(d){this.allFavoriteRecipeObjects=d;const g=[...new Set(d.map(v=>v.category))].sort();r.allCategories=g,r.categoriesLoaded=!0,r.renderCategoryButtons()}else{r.handleEmptyFavorites(),r.hideLoader();return}}const{category:i}=r.currentState,a=9;let o=this.allFavoriteRecipeObjects;i&&(o=this.allFavoriteRecipeObjects.filter(d=>d.category===i));const c=Math.ceil(o.length/a),n=Math.min(e,c)||1;r.currentState.page=n;const p=(n-1)*a,f=o.slice(p,p+a),s={page:n,totalPages:c,results:f};r.createFoodsCard(s),r.hideLoader()}catch(t){h.error({title:"Yükleme Hatası",message:t.message,position:"topRight",timeout:4e3}),r.hideLoader()}}};document.addEventListener("DOMContentLoaded",()=>{l.init(),r.setupEventDelegation()});
//# sourceMappingURL=favorites.js.map
